<?xml version='1.0' encoding='utf-8' standalone='no'?>
<!DOCTYPE issue SYSTEM "lwg-issue.dtd">

<issue num="2976" status="Tentatively Ready">
<title>Dangling <tt>uses_allocator</tt> specialization for <tt>packaged_task</tt></title>
<section><sref ref="[futures.task]"/><sref ref="[future.syn]"/><sref ref="[futures.task.nonmembers]"/></section>
<submitter>Tim Song</submitter>
<date>13 Jun 2017</date>
<priority>99</priority>

<discussion>
<p>
When LWG <iref ref="2921"/> removed allocator support from <tt>packaged_task</tt>, it forgot
to remove the <tt>uses_allocator</tt> partial specialization.
</p>

<note>
2017-07-26 Moved to Tentatively Ready after 6 positive votes on c++std-lib.
</note>
</discussion>

<resolution>
<p>This wording is relative to <a href="http://wg21.link/n4659">N4659</a>.</p>

<ol>
<li>
<p>Modify <sref ref="[future.syn]"/>, header <tt>&lt;future&gt;</tt> synopsis, and
<sref ref="[futures.task]"/>, class template <tt>packaged_task</tt> synopsis, as indicated:</p>

<blockquote>
<pre>
<del>template &lt;class R, class Alloc&gt;
struct uses_allocator&lt;packaged_task&lt;R&gt;, Alloc&gt;;</del>
</pre>
</blockquote>
</li>

<li>
<p>Modify <sref ref="[futures.task.nonmembers]"/> as indicated:</p>

<blockquote>
<pre>
<del>template &lt;class R, class Alloc&gt;
  struct uses_allocator&lt;packaged_task&lt;R&gt;, Alloc&gt;
    : true_type { };</del>
</pre>
<blockquote>
<p>
<del>-2- <i>Requires:</i> <tt>Alloc</tt> shall be an Allocator (20.5.3.5).</del>
</p>
</blockquote>
</blockquote>
</li>
</ol>

</resolution>

</issue>
