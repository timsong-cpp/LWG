<?xml version='1.0' encoding='utf-8' standalone='no'?>
<!DOCTYPE issue SYSTEM "lwg-issue.dtd">

<issue num="3000" status="New">
<title><tt>monotonic_memory_resource::do_is_equal</tt> uses <tt>dynamic_cast</tt> unnecessarily</title>
<section><sref ref="[mem.res.monotonic.buffer.mem]"/></section>
<submitter>Pablo Halpern</submitter>
<date>14 Jul 2017</date>
<priority>99</priority>

<discussion>
<p>
Section [mem.res.monotonic.buffer.mem], paragraph 11 says
</p>
<blockquote>
<pre>
bool do_is_equal(const memory_resource&amp; other) const noexcept override;
</pre>
<blockquote>
<p>
<i>Returns:</i> <tt>this == dynamic_cast&lt;const monotonic_buffer_resource*&gt;(&amp;other)</tt>.
</p>
</blockquote>
</blockquote>
<p>
The <tt>dynamic_cast</tt> adds nothing of value. It is an incorrect cut-and-paste from an example <tt>do_is_equal</tt> 
for a more complex resource.
</p>
  
<note>2017-07-16, Tim Song comments</note>
<p>
The pool resource classes appear to also have this issue.
</p>
</discussion>

<resolution>
<p>This resolution is relative to <a href="http://wg21.link/n4659">N4659</a>.</p>

<ol>
<li><p>Edit <sref ref="[mem.res.monotonic.buffer.mem]"/> as indicated:</p>

<blockquote><pre>
bool do_is_equal(const memory_resource&amp; other) const noexcept override;
</pre>
<blockquote>
<p>
<i>Returns:</i> <tt>this == <del>dynamic_cast&lt;const monotonic_buffer_resource*&gt;(</del>&amp;other<del>)</del></tt>.
</p>
</blockquote>
</blockquote>
</li>

</ol>
</resolution>
</issue>
